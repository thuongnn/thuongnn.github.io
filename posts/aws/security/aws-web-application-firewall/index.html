<!DOCTYPE html><html lang="en" class="scroll-smooth" data-astro-cid-sckkx6r4> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="canonical" href="https://thuongnn.dev/posts/aws/security/aws-web-application-firewall/"><meta name="generator" content="Astro v5.5.2"><!-- General Meta Tags --><title>[AWS] AWS Web Application Firewall | thuongnn.dev</title><meta name="title" content="[AWS] AWS Web Application Firewall | thuongnn.dev"><meta name="description" content="Tìm hiểu về Web Application Firewall của AWS, giúp bảo vệ ứng dụng web khỏi các cuộc tấn công phổ biến."><meta name="author" content="thuongnn"><link rel="sitemap" href="/sitemap-index.xml"><!-- Open Graph / Facebook --><meta property="og:title" content="[AWS] AWS Web Application Firewall | thuongnn.dev"><meta property="og:description" content="Tìm hiểu về Web Application Firewall của AWS, giúp bảo vệ ứng dụng web khỏi các cuộc tấn công phổ biến."><meta property="og:url" content="https://thuongnn.dev/posts/aws/security/aws-web-application-firewall/"><meta property="og:image" content="https://thuongnn.dev/_astro/1.BmHvO73d.png"><!-- Article Published/Modified time --><meta property="article:published_time" content="2023-07-27T09:15:33.000Z"><meta property="article:modified_time" content="2023-07-27T09:15:33.000Z"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://thuongnn.dev/posts/aws/security/aws-web-application-firewall/"><meta property="twitter:title" content="[AWS] AWS Web Application Firewall | thuongnn.dev"><meta property="twitter:description" content="Tìm hiểu về Web Application Firewall của AWS, giúp bảo vệ ứng dụng web khỏi các cuộc tấn công phổ biến."><meta property="twitter:image" content="https://thuongnn.dev/_astro/1.BmHvO73d.png"><!-- Google JSON-LD Structured data --><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"[AWS] AWS Web Application Firewall | thuongnn.dev","image":"https://thuongnn.dev/_astro/1.BmHvO73d.png","datePublished":"2023-07-27T09:15:33.000Z","dateModified":"2023-07-27T09:15:33.000Z","author":[{"@type":"Person","name":"thuongnn","url":"https://thuongnn.dev/"}]}</script><!-- Enable RSS feed auto-discovery  --><!-- https://docs.astro.build/en/recipes/rss/#enabling-rss-feed-auto-discovery --><link rel="alternate" type="application/rss+xml" title="thuongnn.dev" href="https://thuongnn.dev/rss.xml"><meta name="theme-color" content=""><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.CMTcOisY.js"></script><script src="/toggle-theme.js"></script><link rel="stylesheet" href="/_astro/about.Bci8pX7o.css">
<style>@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0;mix-blend-mode:plus-lighter}to{opacity:1;mix-blend-mode:plus-lighter}}@keyframes astroFadeOut{0%{opacity:1;mix-blend-mode:plus-lighter}to{opacity:0;mix-blend-mode:plus-lighter}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*),::view-transition-old(*),::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}
[data-astro-image]{width:100%;height:auto;object-fit:var(--fit);object-position:var(--pos);aspect-ratio:var(--w) / var(--h)}[data-astro-image=responsive]{max-width:calc(var(--w) * 1px);max-height:calc(var(--h) * 1px)}[data-astro-image=fixed]{width:calc(var(--w) * 1px);height:calc(var(--h) * 1px)}
</style><style>[data-astro-transition-scope="astro-fam6wyqg-1"] { view-transition-name: aws-aws-web-application-firewall; }@layer astro { ::view-transition-old(aws-aws-web-application-firewall) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(aws-aws-web-application-firewall) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(aws-aws-web-application-firewall) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(aws-aws-web-application-firewall) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-fam6wyqg-1"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-fam6wyqg-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-fam6wyqg-1"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-fam6wyqg-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-fam6wyqg-1"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-fam6wyqg-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-fam6wyqg-1"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-fam6wyqg-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-36ssibgs-2"] { view-transition-name: aws; }@layer astro { ::view-transition-old(aws) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(aws) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(aws) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(aws) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-2"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-2"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-2"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-2"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-36ssibgs-3"] { view-transition-name: amazon-web-services; }@layer astro { ::view-transition-old(amazon-web-services) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(amazon-web-services) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(amazon-web-services) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(amazon-web-services) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-3"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-3"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-3"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-3"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style></head> <body data-astro-cid-sckkx6r4>  <header> <a id="skip-to-content" href="#main-content" class="absolute -top-full left-16 z-50 bg-background px-3 py-2 text-accent backdrop-blur-lg transition-all focus:top-4">
Skip to content
</a> <div id="nav-container" class="mx-auto flex max-w-3xl flex-col items-center justify-between sm:flex-row"> <div id="top-nav-wrap" class="relative flex w-full items-baseline justify-between bg-background p-4 sm:items-center sm:py-6"> <a href="/" class="absolute py-1 text-2xl leading-7 font-semibold whitespace-nowrap sm:static"> thuongnn.dev </a> <nav id="nav-menu" class="flex w-full flex-col items-center sm:ml-2 sm:flex-row sm:justify-end sm:space-x-4 sm:py-0"> <button id="menu-btn" class="focus-outline self-end p-2 sm:hidden" aria-label="Open Menu" aria-expanded="false" aria-controls="menu-items"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="hidden" id="close-icon"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M18 6l-12 12" /><path d="M6 6l12 12" /></svg> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-menu-deep" id="menu-icon"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M4 6h16" /><path d="M7 12h13" /><path d="M10 18h10" /></svg> </button> <ul id="menu-items" class="mt-4 grid w-44 grid-cols-2 place-content-center gap-2 [&#38;>li>a]:block [&#38;>li>a]:px-4 [&#38;>li>a]:py-3 [&#38;>li>a]:text-center [&#38;>li>a]:font-medium [&#38;>li>a]:hover:text-accent sm:[&#38;>li>a]:px-2 sm:[&#38;>li>a]:py-1 hidden sm:mt-0 sm:ml-0 sm:flex sm:w-auto sm:gap-x-5 sm:gap-y-0"> <li class="col-span-2"> <a href="/posts" class="active-nav">
Posts
</a> </li> <li class="col-span-2"> <div class="relative" id="tags-dropdown"> <a href="/tags" class="block px-4 py-3 text-center font-medium hover:text-accent sm:px-2 sm:py-1"> <span class="flex items-center justify-center gap-1">
Tags
<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"> <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path> </svg> </span> </a> <div class="absolute top-full left-0 z-50 mt-1 hidden w-48 rounded-md bg-white py-1 shadow-lg dark:bg-gray-800" id="tags-menu"> <ul class="pt-2 pb-1"> <li> <a class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-800" href="/tags/collections/aws"> Amazon Web Services </a> </li><li> <a class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-800" href="/tags/collections/google-cloud"> Google Cloud Platform </a> </li><li> <a class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-800" href="/tags/collections/computer-science"> Computer Science </a> </li> </ul> </div> </div> </li> <li class="col-span-2"> <a href="/about">
About
</a> </li> <li class="col-span-2"> <a href="/archives" class="group inline-block hover:text-accent focus-outline flex justify-center p-3 sm:p-1" aria-label="archives" title="Archives"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="hidden sm:inline-block"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M3 4m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z" /><path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" /><path d="M10 12l4 0" /></svg> <span class="sm:sr-only">Archives</span> </a> </li> <li class="col-span-1 flex items-center justify-center"> <a href="/search" class="group inline-block hover:text-accent focus-outline flex p-3 sm:p-1" aria-label="search" title="Search"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-search"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg> <span class="sr-only">Search</span> </a> </li> <li class="col-span-1 flex items-center justify-center"> <button id="theme-btn" class="focus-outline relative size-12 p-4 sm:size-8 hover:[&>svg]:stroke-accent" title="Toggles light & dark" aria-label="auto" aria-live="polite"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="absolute top-[50%] left-[50%] -translate-[50%] scale-100 rotate-0 transition-all dark:scale-0 dark:-rotate-90"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" /></svg> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="absolute top-[50%] left-[50%] -translate-[50%] scale-0 rotate-90 transition-all dark:scale-100 dark:rotate-0"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z" /><path d="M6.343 17.657l-1.414 1.414" /><path d="M6.343 6.343l-1.414 -1.414" /><path d="M17.657 6.343l1.414 -1.414" /><path d="M17.657 17.657l1.414 1.414" /><path d="M4 12h-2" /><path d="M12 4v-2" /><path d="M20 12h2" /><path d="M12 20v2" /></svg> </button> </li> </ul> </nav> </div> </div> <div class="max-w-3xl mx-auto px-4"> <hr class="border-border" aria-hidden="true"> </div> </header> <script type="module">function d(){const e=document.querySelector("#menu-btn"),t=document.querySelector("#menu-items"),n=document.querySelector("#menu-icon"),o=document.querySelector("#close-icon");!e||!t||!n||!o||e.addEventListener("click",()=>{const s=e.getAttribute("aria-expanded")==="true";e.setAttribute("aria-expanded",s?"false":"true"),e.setAttribute("aria-label",s?"Open Menu":"Close Menu"),t.classList.toggle("hidden"),n.classList.toggle("hidden"),o.classList.toggle("hidden")})}function u(){const e=document.getElementById("tags-dropdown"),t=document.getElementById("tags-menu");let n;!e||!t||(e.addEventListener("mouseenter",()=>{clearTimeout(n),t.classList.remove("hidden")}),e.addEventListener("mouseleave",()=>{n=setTimeout(()=>{t.classList.add("hidden")},100)}))}d();u();document.addEventListener("astro:after-swap",()=>{d(),u()});</script> <div class="mx-auto flex w-full max-w-3xl items-center justify-start px-2"><a id="back-button" href="/" class="group inline-block hover:text-accent focus-outline mt-8 mb-2 flex hover:text-foreground/75"><svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M15 6l-6 6l6 6" /></svg><span>Go back</span></a></div><script type="module">function o(){const t=document.querySelector("#back-button"),e=sessionStorage.getItem("backUrl");e&&t&&(t.href=e)}document.addEventListener("astro:page-load",o);o();</script> <main id="main-content" class="mx-auto w-full max-w-3xl px-4 pb-12" data-pagefind-body> <h1 class="inline-block text-2xl font-bold text-accent sm:text-3xl" data-astro-transition-scope="astro-fam6wyqg-1"> [AWS] AWS Web Application Firewall </h1> <div class="flex items-center gap-4"> <div class="flex items-end space-x-2 opacity-80 my-2"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 min-w-[1.375rem]"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z" /><path d="M16 3v4" /><path d="M8 3v4" /><path d="M4 11h16" /><path d="M7 14h.013" /><path d="M10.01 14h.005" /><path d="M13.01 14h.005" /><path d="M16.015 14h.005" /><path d="M13.015 17h.005" /><path d="M7.01 17h.005" /><path d="M10.01 17h.005" /></svg> <span class="sr-only">Published:</span> <span class="text-sm italic sm:text-base"> <time datetime="2023-07-27T09:15:33.000Z">27 Jul, 2023</time> <span aria-hidden="true"> | </span> <span class="sr-only">&nbsp;at&nbsp;</span> <span class="text-nowrap">09:15 AM</span> </span> </div> <div class="opacity-80 max-sm:hidden"><span aria-hidden="true" class="max-sm:hidden">
|
</span><a class="space-x-1.5 hover:opacity-75" href="https://github.com/thuongnn/thuongnn.github.io/edit/master/src/data/blog/aws/security/aws-web-application-firewall.md" rel="noopener noreferrer" target="_blank"><svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1" /><path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z" /><path d="M16 5l3 3" /></svg><span class="italic max-sm:text-sm sm:inline">Suggest Changes</span></a></div> </div> <article id="article" class="mx-auto prose mt-8 max-w-3xl"> <p>Bài viết được tham khảo và tổng hợp lại từ Jayendra’s Blog, xem bài viết gốc ở đây: <a href="https://jayendrapatil.com/aws-waf">https://jayendrapatil.com/aws-waf</a>.</p>
<h2 id="table-of-contents">Table of contents</h2>
<p></p><details><summary>Open Table of contents</summary><p></p>
<ul>
<li><a href="#aws-web-application-firewall-waf"><strong>AWS Web Application Firewall (WAF)</strong></a></li>
<li><a href="#waf-benefits">WAF Benefits</a></li>
<li><a href="#how-waf-works">How WAF Works</a>
<ul>
<li><a href="#conditions"><strong>Conditions</strong></a></li>
<li><a href="#actions"><strong>Actions</strong></a></li>
<li><a href="#rules"><strong>Rules</strong></a></li>
<li><a href="#rule-groups"><strong>Rule Groups</strong></a></li>
<li><a href="#web-acls-web-access-control-lists"><strong>Web ACLs (Web Access Control Lists)</strong></a></li>
</ul>
</li>
<li><a href="#aws-waf-based-architecture">AWS WAF based Architecture</a>
<ul>
<li><a href="#1-cloudfront-nh%E1%BA%ADn-c%C3%A1c-y%C3%AAu-c%E1%BA%A7u-web"><strong>1. CloudFront Nhận Các Yêu Cầu Web</strong></a></li>
<li><a href="#2-s3-bucket-l%C6%B0u-tr%E1%BB%AF-nh%E1%BA%ADt-k%C3%BD-truy-c%E1%BA%ADp"><strong>2. S3 Bucket Lưu Trữ Nhật Ký Truy Cập</strong></a></li>
<li><a href="#3-lambda-function-x%E1%BB%AD-l%C3%BD-nh%E1%BA%ADt-k%C3%BD"><strong>3. Lambda Function Xử Lý Nhật Ký</strong></a></li>
<li><a href="#4-l%C6%B0u-tr%E1%BB%AF-t%E1%BA%A1m-th%E1%BB%9Di-trong-s3"><strong>4. Lưu Trữ Tạm Thời trong S3</strong></a></li>
<li><a href="#5-c%E1%BA%ADp-nh%E1%BA%ADt-quy-t%E1%BA%AFc-aws-waf"><strong>5. Cập Nhật Quy Tắc AWS WAF</strong></a></li>
<li><a href="#6-gi%C3%A1m-s%C3%A1t-v%C3%A0-th%E1%BB%91ng-k%C3%AA-qua-cloudwatch"><strong>6. Giám Sát và Thống Kê qua CloudWatch</strong></a></li>
<li><a href="#7-t%C3%ADch-h%E1%BB%A3p-th%C3%B4ng-b%C3%A1o-sns"><strong>7. Tích Hợp Thông Báo SNS</strong></a></li>
</ul>
</li>
<li><a href="#web-application-firewall-sandwich-architecture">Web Application Firewall Sandwich Architecture</a>
<ul>
<li><a href="#c%C3%A1c-cu%E1%BB%99c-t%E1%BA%A5n-c%C3%B4ng-ddos-%E1%BB%9F-l%E1%BB%9Bp-%E1%BB%A9ng-d%E1%BB%A5ng-v%C3%A0-c%C3%A1ch-waf-gi%C3%BAp-gi%E1%BA%A3m-thi%E1%BB%83u"><strong>Các cuộc tấn công DDoS ở lớp ứng dụng và cách WAF giúp giảm thiểu</strong></a></li>
<li><a href="#c%C3%A1ch-waf-ho%E1%BA%A1t-%C4%91%E1%BB%99ng"><strong>Cách WAF Hoạt Động</strong></a></li>
<li><a href="#c%C3%A1c-lo%E1%BA%A1i-t%E1%BA%A5n-c%C3%B4ng-ddos"><strong>Các Loại Tấn Công DDoS</strong></a></li>
<li><a href="#c%C3%A1c-t%C3%ADnh-n%C4%83ng-c%E1%BB%A7a-waf-%C4%91%E1%BB%83-ng%C4%83n-ch%E1%BA%B7n-t%E1%BA%A5n-c%C3%B4ng-ddos"><strong>Các Tính Năng của WAF để Ngăn Chặn Tấn Công DDoS</strong></a></li>
<li><a href="#m%C3%B4-h%C3%ACnh-waf-sandwich"><strong>Mô Hình “WAF Sandwich”</strong></a></li>
<li><a href="#quy-tr%C3%ACnh-ho%E1%BA%A1t-%C4%91%E1%BB%99ng"><strong>Quy Trình Hoạt Động</strong></a></li>
<li><a href="#l%E1%BB%A3i-%C3%ADch-c%E1%BB%A7a-c%E1%BA%A5u-h%C3%ACnh-n%C3%A0y"><strong>Lợi Ích của Cấu Hình Này</strong></a></li>
</ul>
</li>
</ul>
<p></p></details><p></p>
<h1 id="aws-web-application-firewall-waf"><strong>AWS Web Application Firewall (WAF)</strong></h1>
<ul>
<li><strong>AWS WAF</strong> là dịch vụ bảo vệ ứng dụng web khỏi các cuộc tấn công bằng cách cho phép cấu hình các quy tắc để cho phép, chặn hoặc giám sát (đếm) các yêu cầu web dựa trên các điều kiện đã định nghĩa.</li>
<li><strong>Các tính năng chính của AWS WAF:</strong>
<ul>
<li><strong>Bảo vệ khỏi các kỹ thuật tấn công phổ biến:</strong>
<ul>
<li><strong>SQL Injection</strong></li>
<li><strong>Cross-Site Scripting (XSS)</strong></li>
</ul>
</li>
<li><strong>Cấu hình điều kiện bảo vệ (Conditions):</strong>
<ul>
<li><strong>Địa chỉ IP</strong>: Có thể cấu hình để cho phép hoặc chặn yêu cầu từ các địa chỉ IP cụ thể.</li>
<li><strong>HTTP Headers</strong>: Kiểm tra các header trong yêu cầu HTTP.</li>
<li><strong>HTTP Body</strong>: Kiểm tra nội dung trong phần thân của yêu cầu HTTP.</li>
<li><strong>URI Strings</strong>: Kiểm tra chuỗi URI trong yêu cầu.</li>
</ul>
</li>
<li><strong>Tích hợp với các dịch vụ của AWS:</strong>
<ul>
<li><strong>AWS WAF với Amazon CloudFront</strong>:
<ul>
<li><strong>Chạy tại các Edge Locations của AWS trên toàn cầu</strong>, giúp bảo vệ các yêu cầu web từ người dùng gần nhất.</li>
<li><strong>Chặn yêu cầu độc hại trước khi đến máy chủ web</strong>.</li>
<li><strong>Hỗ trợ các nguồn tùy chỉnh ngoài AWS</strong>, cho phép bảo vệ các tài nguyên không phải của AWS.</li>
</ul>
</li>
<li><strong>AWS WAF với Application Load Balancer (ALB):</strong>
<ul>
<li><strong>Chạy trong region</strong>, có thể bảo vệ cả public và internal <strong>Load Balancer</strong>.</li>
<li><strong>Chặn yêu cầu độc hại</strong> trước khi chúng tiếp cận các ứng dụng web.</li>
</ul>
</li>
<li><strong>AWS WAF với API Gateway:</strong>
<ul>
<li><strong>Bảo vệ các REST API</strong>, giúp bảo vệ các ứng dụng và kiểm tra các yêu cầu HTTP hoặc HTTPS.</li>
<li>Cung cấp các <strong>Managed Rules</strong> để bảo vệ khỏi các mối đe dọa như các lỗ hổng ứng dụng (ví dụ như OWASP), bot, hoặc các lỗ hổng bảo mật và triển khai thông qua các quy tắc như Common Vulnerabilities and Exposures (CVE).</li>
<li><strong>Lưu trữ log</strong>: Các log có thể được gửi đến <strong>CloudWatch Logs</strong>, <strong>S3 bucket</strong>, hoặc <strong>Kinesis Data Firehose</strong>.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="waf-benefits">WAF Benefits</h1>
<ul>
<li><strong>Bảo vệ bổ sung chống lại các cuộc tấn công web</strong>:
<ul>
<li>Bằng cách định nghĩa các điều kiện như <strong>địa chỉ IP</strong>, <strong>header yêu cầu</strong>, <strong>chuỗi trong yêu cầu</strong>, và <strong>dữ liệu độc hại</strong> (SQL injection, XSS).</li>
</ul>
</li>
<li><strong>Quy tắc được quản lý sẵn (Managed Rules)</strong>:
<ul>
<li>Giúp bạn bắt đầu dễ dàng và nhanh chóng với các quy tắc đã được cấu hình sẵn để bảo vệ ứng dụng khỏi các mối đe dọa phổ biến.</li>
</ul>
</li>
<li><strong>Quản lý dễ dàng</strong>:
<ul>
<li><strong>API WAF</strong> cho phép tự động hóa các tác vụ quản lý WAF.</li>
<li><strong>Quy tắc có thể tái sử dụng</strong> cho nhiều ứng dụng web khác nhau.</li>
</ul>
</li>
<li><strong>Theo dõi thời gian thực</strong>:
<ul>
<li>Cung cấp <strong>thống kê theo thời gian thực</strong> và <strong>yêu cầu web mẫu</strong> để giám sát hiệu quả bảo vệ và phát hiện các vấn đề bảo mật.</li>
</ul>
</li>
<li><strong>Linh hoạt trong việc xử lý các yêu cầu</strong>:
<ul>
<li><strong>Chặn</strong>, <strong>cho phép</strong>, hoặc <strong>giám sát</strong> các yêu cầu theo các quy tắc đã cấu hình, giúp bảo vệ ứng dụng khỏi các tấn công trên môi trường web.</li>
</ul>
</li>
</ul>
<h1 id="how-waf-works">How WAF Works</h1>
<p>AWS WAF (Web Application Firewall) cho phép kiểm soát hành vi của các yêu cầu web thông qua sự kết hợp của <strong>conditions</strong>, <strong>rules</strong> và <strong>web access control lists (Web ACLs)</strong>.</p>
<p><img alt="1.png" sizes="(min-width: 1536px) 1536px, 100vw" loading="lazy" decoding="async" fetchpriority="auto" style="--w: 1536; --h: 742;" data-astro-image="responsive" width="1536" height="742" src="/_astro/1.BmHvO73d_Z2lLujA.webp" srcset="/_astro/1.BmHvO73d_yybr3.webp 640w, /_astro/1.BmHvO73d_Z2nvJXI.webp 750w, /_astro/1.BmHvO73d_ZtgFeT.webp 828w, /_astro/1.BmHvO73d_Z1uPe6t.webp 1080w, /_astro/1.BmHvO73d_Z14QFJq.webp 1280w, /_astro/1.BmHvO73d_Z2lLujA.webp 1536w"></p>
<h2 id="conditions"><strong>Conditions</strong></h2>
<p>Điều kiện xác định các đặc điểm cụ thể của các yêu cầu web mà AWS WAF sẽ theo dõi. Các điều kiện này có thể bao gồm:</p>
<ul>
<li><strong>Mã độc hại (XSS)</strong>: Phát hiện các cuộc tấn công Cross-Site Scripting (XSS), trong đó kẻ tấn công nhúng mã script vào ứng dụng web để khai thác các lỗ hổng bảo mật.</li>
<li><strong>Địa chỉ IP hoặc Dải Địa Chỉ IP</strong>: Xác định địa chỉ IP hoặc dải địa chỉ IP mà yêu cầu web xuất phát từ đó.</li>
<li><strong>Kích Thước</strong>: Theo dõi độ dài của các phần cụ thể trong yêu cầu web, chẳng hạn như chuỗi truy vấn hoặc tiêu đề.</li>
<li><strong>SQL Mã độc (SQL Injection)</strong>: Phát hiện các cuộc tấn công SQL Injection, trong đó kẻ tấn công cố gắng chèn mã SQL độc hại vào yêu cầu web để truy xuất dữ liệu từ cơ sở dữ liệu.</li>
<li><strong>Khớp Địa Lý</strong>: Cho phép hoặc chặn các yêu cầu dựa trên quốc gia mà chúng xuất phát.</li>
<li><strong>Khớp Chuỗi</strong>: Tìm kiếm các chuỗi cụ thể trong yêu cầu, chẳng hạn như giá trị trong tiêu đề <strong>User-Agent</strong> hoặc văn bản chuỗi truy vấn.</li>
</ul>
<p>Một số điều kiện có thể <strong>nhận nhiều giá trị</strong>, cho phép khớp phức tạp hơn.</p>
<h2 id="actions"><strong>Actions</strong></h2>
<p>Dựa trên các điều kiện, AWS WAF có thể thực hiện một số hành động:</p>
<ul>
<li><strong>Cho phép</strong>: Cho phép tất cả các yêu cầu ngoại trừ những yêu cầu khớp với các điều kiện cụ thể (danh sách đen).</li>
<li><strong>Chặn</strong>: Chặn tất cả các yêu cầu ngoại trừ những yêu cầu khớp với các điều kiện cụ thể (danh sách trắng).</li>
<li><strong>Giám sát (Đếm)</strong>: Đếm số lượng yêu cầu khớp với các đặc điểm cụ thể mà không chặn chúng. Điều này hữu ích khi kiểm tra các cấu hình mới để đảm bảo chúng không vô tình chặn lưu lượng hợp pháp.</li>
<li><strong>CAPTCHA</strong>: Kiểm tra CAPTCHA đối với các yêu cầu để xác minh xem chúng có đến từ bot hay người dùng thật.</li>
</ul>
<h2 id="rules"><strong>Rules</strong></h2>
<p>Các quy tắc AWS WAF xác định cách kiểm tra các yêu cầu HTTP(S) và hành động thực hiện khi yêu cầu khớp với các điều kiện cụ thể.</p>
<ul>
<li>Mỗi quy tắc có một hoặc nhiều top-level rule statement. Các statement này có thể bao gồm các statement lồng nhau để có logic phức tạp hơn.</li>
<li>AWS WAF hỗ trợ các toán tử logic như <strong>AND</strong>, <strong>OR</strong>, và <strong>NOT</strong> để kết hợp nhiều điều kiện trong một quy tắc. Ví dụ, một quy tắc có thể yêu cầu:
<ul>
<li>Yêu cầu đến từ IP <code>192.0.2.44</code></li>
<li>Chứa “BadBot” trong tiêu đề <strong>User-Agent</strong></li>
<li>Bao gồm mã SQL độc hại trong chuỗi truy vấn.</li>
<li>Tất cả ba điều kiện phải được thỏa mãn (AND) để quy tắc được kích hoạt và hành động tương ứng được thực hiện.</li>
</ul>
</li>
</ul>
<h2 id="rule-groups"><strong>Rule Groups</strong></h2>
<p><strong>Rule Groups</strong> là một tập hợp các quy tắc có thể được tái sử dụng và thêm vào Web ACL. Rule groups chia thành ba loại chính:</p>
<ul>
<li>Các rule do AWS Quản lý và các bên bán từ AWS Marketplace tạo ra và duy trì.</li>
<li>Các rule do người dùng tạo và duy trì.</li>
<li>Các rule do các dịch vụ khác như AWS Firewall Manager hoặc Shield Advanced quản lý.</li>
</ul>
<h2 id="web-acls-web-access-control-lists"><strong>Web ACLs (Web Access Control Lists)</strong></h2>
<p><strong>Web ACL</strong> cung cấp kiểm soát chi tiết đối với các yêu cầu web mà tài nguyên được bảo vệ phản hồi. Các tính năng chính của Web ACL bao gồm:</p>
<ul>
<li>Có thể kết hợp nhiều rule hoặc rule groups.</li>
<li>Xác định hành động (cho phép, chặn hoặc đếm) cho mỗi rule.</li>
<li>AWS WAF so sánh mỗi yêu cầu với các rule trong Web ACL, theo thứ tự đã được chỉ định. Nếu yêu cầu khớp với rule, hành động định sẵn cho rule đó được thực hiện, và việc đánh giá sẽ dừng lại.</li>
<li>Nếu không có rule nào khớp với yêu cầu, hành động mặc định của Web ACL sẽ quyết định liệu yêu cầu có bị chặn hay cho phép. Điều này có thể dựa trên các tiêu chí như:
<ul>
<li><strong>Địa chỉ IP</strong> nguồn</li>
<li><strong>Quốc gia xuất phát</strong></li>
<li><strong>Khớp Chuỗi hoặc Regex</strong> trong các phần của yêu cầu</li>
<li><strong>Kích thước của một phần yêu cầu</strong></li>
<li><strong>Phát hiện SQL hay mã độc</strong></li>
<li><strong>Rule dựa trên tần suất yêu cầu</strong> để phát hiện các cuộc tấn công DDoS.</li>
</ul>
</li>
<li>AWS WAF cũng hỗ trợ <strong>rule dựa trên tần suất</strong>, có thể tự động chặn các yêu cầu từ địa chỉ IP vượt quá ngưỡng yêu cầu trong một khoảng thời gian xác định. Điều này giúp bảo vệ chống lại các cuộc tấn công DDoS (Distributed Denial of Service)</li>
</ul>
<h1 id="aws-waf-based-architecture">AWS WAF based Architecture</h1>
<p><img alt="2.png" sizes="(min-width: 742px) 742px, 100vw" loading="lazy" decoding="async" fetchpriority="auto" style="--w: 742; --h: 425;" data-astro-image="responsive" width="742" height="425" src="/_astro/2.D-FRRriE_Z2svI5N.webp" srcset="/_astro/2.D-FRRriE_ZpQX7k.webp 640w, /_astro/2.D-FRRriE_Z2svI5N.webp 742w"></p>
<p>Kiến trúc này mô tả cách AWS WAF tích hợp với AWS CloudFront, Lambda và S3 để cập nhật các quy tắc WAF động dựa trên các mẫu yêu cầu. Dưới đây là phân tích các thành phần và cách chúng tương tác:</p>
<h2 id="1-cloudfront-nhận-các-yêu-cầu-web"><strong>1. CloudFront Nhận Các Yêu Cầu Web</strong></h2>
<ul>
<li><strong>CloudFront</strong> hoạt động như một mạng phân phối nội dung (CDN) xử lý các yêu cầu web thay mặt cho ứng dụng web của bạn.</li>
<li><strong>Gửi yêu cầu</strong> đến ứng dụng của bạn, lưu trữ nội dung và cung cấp quyền truy cập nhanh cho người dùng.</li>
<li><strong>Ghi lại nhật ký truy cập</strong>: CloudFront ghi lại chi tiết các yêu cầu mà nó xử lý và gửi chúng đến một <strong>S3 bucket</strong> để lưu trữ. Những nhật ký này chứa thông tin như địa chỉ IP, URL yêu cầu, mã trạng thái phản hồi, v.v.</li>
</ul>
<h2 id="2-s3-bucket-lưu-trữ-nhật-ký-truy-cập"><strong>2. S3 Bucket Lưu Trữ Nhật Ký Truy Cập</strong></h2>
<ul>
<li><strong>S3 bucket</strong> lưu trữ tất cả các nhật ký truy cập của CloudFront. Các nhật ký này có thể được Lambda function truy cập để xử lý.</li>
<li>Mỗi khi một nhật ký mới được lưu trữ trong S3 bucket, một <strong>Lambda function</strong> sẽ được kích hoạt để xử lý các nhật ký.</li>
</ul>
<h2 id="3-lambda-function-xử-lý-nhật-ký"><strong>3. Lambda Function Xử Lý Nhật Ký</strong></h2>
<ul>
<li><strong>Phân tích Nhật Ký</strong>: Lambda function được kích hoạt mỗi khi có nhật ký mới được thêm vào S3 bucket. Nó phân tích các tệp nhật ký để kiểm tra các mẫu yêu cầu và mã lỗi.</li>
<li><strong>Xác định Các Yêu Cầu Xấu</strong>: Lambda function tìm các yêu cầu gây ra mã lỗi HTTP như:
<ul>
<li><strong>400</strong> (Yêu cầu không hợp lệ)</li>
<li><strong>403</strong> (Cấm)</li>
<li><strong>404</strong> (Không tìm thấy)</li>
<li><strong>405</strong> (Phương thức không được phép)</li>
</ul>
</li>
<li><strong>Đếm Các Yêu Cầu Xấu</strong>: Hàm Lambda đếm số lượng yêu cầu gây ra các lỗi này, xác định các địa chỉ IP có thể là yêu cầu xâm phạm hoặc sai sót.</li>
</ul>
<h2 id="4-lưu-trữ-tạm-thời-trong-s3"><strong>4. Lưu Trữ Tạm Thời trong S3</strong></h2>
<ul>
<li>Lambda function lưu trữ kết quả phân tích (như các bad IP Address) tạm thời trong S3 bucket. Điều này cho phép xử lý thêm và theo dõi các địa chỉ IP liên quan đến yêu cầu không mong muốn.</li>
</ul>
<h2 id="5-cập-nhật-quy-tắc-aws-waf"><strong>5. Cập Nhật Quy Tắc AWS WAF</strong></h2>
<ul>
<li><strong>Cập Nhật Động</strong>: Dựa trên phân tích các nhật ký truy cập, Lambda function cập nhật <strong>quy tắc AWS WAF</strong> để chặn các địa chỉ IP đã xác định.</li>
<li><strong>Chặn Tạm Thời</strong>: Lambda function có thể thiết lập <strong>thời gian chặn tạm thời</strong> cho các địa chỉ IP này (ví dụ: vài giờ hoặc vài ngày). Trong thời gian này, WAF sẽ chặn yêu cầu từ các IP này để giảm thiểu các cuộc tấn công hoặc hành vi xâm phạm.</li>
<li>Sau khi hết thời gian chặn, <strong>AWS WAF sẽ cho phép</strong> các địa chỉ IP này truy cập lại vào ứng dụng của bạn nhưng vẫn tiếp tục theo dõi hoạt động của chúng.</li>
</ul>
<h2 id="6-giám-sát-và-thống-kê-qua-cloudwatch"><strong>6. Giám Sát và Thống Kê qua CloudWatch</strong></h2>
<ul>
<li><strong>Thông Số Thực Thi</strong>: Lambda function xuất bản các thông số thực thi vào <strong>CloudWatch</strong>, bao gồm:
<ul>
<li>Số lượng <strong>yêu cầu</strong> đã phân tích.</li>
<li>Số lượng <strong>địa chỉ IP</strong> đã bị chặn.</li>
<li><strong>Dữ liệu liên quan khác</strong> (ví dụ: số lượng mã lỗi phát hiện được).</li>
</ul>
</li>
<li>Những thông số này giúp giám sát hiệu quả của Lambda function và các cập nhật của WAF.</li>
</ul>
<h2 id="7-tích-hợp-thông-báo-sns"><strong>7. Tích Hợp Thông Báo SNS</strong></h2>
<ul>
<li><strong>Tích Hợp CloudWatch với SNS</strong>: Các thông số từ CloudWatch có thể được tích hợp với <strong>Simple Notification Service (SNS)</strong> để gửi thông báo. Điều này giúp các quản trị viên nhận được cảnh báo khi các ngưỡng nhất định được đạt tới, chẳng hạn như:
<ul>
<li>Một số lượng yêu cầu nhất định gây ra mã lỗi.</li>
<li>Một số lượng địa chỉ IP nhất định bị chặn.</li>
<li>Các thông số hiệu suất hoặc bảo mật khác.</li>
</ul>
</li>
</ul>
<h1 id="web-application-firewall-sandwich-architecture">Web Application Firewall Sandwich Architecture</h1>
<p><img alt="3.png" sizes="(min-width: 2254px) 2254px, 100vw" loading="lazy" decoding="async" fetchpriority="auto" style="--w: 2254; --h: 1198;" data-astro-image="responsive" width="2254" height="1198" src="/_astro/3.CZ5m_dYZ_Z10w2Ly.webp" srcset="/_astro/3.CZ5m_dYZ_1wIvLa.webp 640w, /_astro/3.CZ5m_dYZ_1TMI94.webp 750w, /_astro/3.CZ5m_dYZ_Z24SKGI.webp 828w, /_astro/3.CZ5m_dYZ_1IXg8R.webp 1080w, /_astro/3.CZ5m_dYZ_8sOFM.webp 1280w, /_astro/3.CZ5m_dYZ_d4kNg.webp 1668w, /_astro/3.CZ5m_dYZ_7x741.webp 2048w, /_astro/3.CZ5m_dYZ_Z10w2Ly.webp 2254w"></p>
<h2 id="các-cuộc-tấn-công-ddos-ở-lớp-ứng-dụng-và-cách-waf-giúp-giảm-thiểu"><strong>Các cuộc tấn công DDoS ở lớp ứng dụng và cách WAF giúp giảm thiểu</strong></h2>
<p>Các cuộc tấn công DDoS ở lớp ứng dụng thường nhắm vào các ứng dụng web với lưu lượng thấp hơn so với các cuộc tấn công hạ tầng. <strong>WAF</strong> có thể được tích hợp như một phần của hạ tầng để giảm thiểu các cuộc tấn công này.</p>
<h2 id="cách-waf-hoạt-động"><strong>Cách WAF Hoạt Động</strong></h2>
<p>WAF hoạt động như một bộ lọc áp dụng một tập hợp các quy tắc vào lưu lượng web, nhằm bảo vệ ứng dụng khỏi các lỗ hổng như <strong>XSS</strong> (Cross-Site Scripting) và <strong>SQL Injection</strong>. Bên cạnh đó, WAF cũng có thể giúp tăng cường khả năng chống lại các cuộc tấn công DDoS bằng cách giảm thiểu các cuộc tấn công <strong>HTTP GET</strong> hoặc <strong>POST flood</strong>.</p>
<h2 id="các-loại-tấn-công-ddos"><strong>Các Loại Tấn Công DDoS</strong></h2>
<ul>
<li><strong>HTTP GET Floods</strong>: Đây là kiểu tấn công yêu cầu một URL cụ thể với tần suất rất cao hoặc yêu cầu tất cả các đối tượng từ ứng dụng của bạn. Mục tiêu là làm quá tải các tài nguyên của ứng dụng bằng cách gửi nhiều yêu cầu.</li>
<li><strong>HTTP POST Floods</strong>: Tấn công này tìm các quá trình tốn kém trong ứng dụng, ví dụ như đăng nhập hoặc tìm kiếm trong cơ sở dữ liệu, và cố gắng kích hoạt chúng để làm quá tải ứng dụng.</li>
</ul>
<h2 id="các-tính-năng-của-waf-để-ngăn-chặn-tấn-công-ddos"><strong>Các Tính Năng của WAF để Ngăn Chặn Tấn Công DDoS</strong></h2>
<ul>
<li><strong>Giới hạn tần suất HTTP</strong>: WAF có thể giới hạn số lượng yêu cầu mà mỗi người dùng có thể gửi trong một khoảng thời gian nhất định. Khi vượt quá ngưỡng này, WAF có thể chặn hoặc lưu trữ các yêu cầu mới để đảm bảo người dùng khác vẫn có thể truy cập ứng dụng.</li>
<li><strong>Kiểm tra các yêu cầu HTTP</strong>: WAF có thể kiểm tra và nhận diện các yêu cầu không phù hợp với các mẫu thông thường.</li>
</ul>
<h2 id="mô-hình-waf-sandwich"><strong>Mô Hình “WAF Sandwich”</strong></h2>
<p>Trong mô hình <strong>“WAF sandwich”</strong>, EC2 chạy phần mềm WAF (không phải AWS WAF) được đặt trong một nhóm <strong>Auto Scaling</strong> và nằm giữa hai <strong>ELB</strong> (Elastic Load Balancer).</p>
<ul>
<li><strong>Load balancer frontend</strong>: Đây là một load balancer công cộng trong VPC mặc định, có nhiệm vụ phân phối tất cả lưu lượng vào EC2 chạy phần mềm WAF.</li>
<li>Khi có lượng lưu lượng tăng đột biến, mô hình này cho phép tự động mở rộng và thêm các EC2 WAF mới để đáp ứng yêu cầu.</li>
</ul>
<h2 id="quy-trình-hoạt-động"><strong>Quy Trình Hoạt Động</strong></h2>
<ol>
<li><strong>Lưu lượng đến WAF EC2</strong>: Tất cả lưu lượng từ người dùng sẽ được chuyển đến EC2 chạy WAF thông qua load balancer phía trước.</li>
<li><strong>Kiểm tra và lọc lưu lượng</strong>: Sau khi lưu lượng đã được kiểm tra và lọc, WAF EC2 sẽ chuyển lưu lượng đã lọc tới <strong>load balancer backend</strong>.</li>
<li><strong>Phân phối tới ứng dụng</strong>: Load balancer nội bộ sẽ phân phối lưu lượng vào các <strong>EC2 ứng dụng</strong> của bạn.</li>
</ol>
<h2 id="lợi-ích-của-cấu-hình-này"><strong>Lợi Ích của Cấu Hình Này</strong></h2>
<p>Cấu hình này cho phép các EC2 WAF có thể mở rộng và đáp ứng yêu cầu mà không ảnh hưởng đến khả năng sẵn có của ứng dụng EC2, giúp bảo vệ ứng dụng khỏi các cuộc tấn công mà vẫn duy trì hoạt động ổn định.</p> </article> <hr class="my-8 border-dashed"> <div class="opacity-80 sm:hidden"><span aria-hidden="true" class="max-sm:hidden">
|
</span><a class="space-x-1.5 hover:opacity-75" href="https://github.com/thuongnn/thuongnn.github.io/edit/master/src/data/blog/aws/security/aws-web-application-firewall.md" rel="noopener noreferrer" target="_blank"><svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1" /><path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z" /><path d="M16 5l3 3" /></svg><span class="italic max-sm:text-sm sm:inline">Suggest Changes</span></a></div> <ul class="mt-4 mb-8 sm:my-8"> <li class="group inline-block group-hover:cursor-pointer my-1 underline-offset-4"> <a href="/tags/aws/" class="relative pr-2 text-lg underline decoration-dashed group-hover:-top-0.5 group-hover:text-accent focus-visible:p-1 text-sm" data-astro-transition-scope="astro-36ssibgs-2"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block opacity-80 -mr-3.5 size-4"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M5 9l14 0" /><path d="M5 15l14 0" /><path d="M11 4l-4 16" /><path d="M17 4l-4 16" /></svg>
&nbsp;<span>AWS</span> </a> </li><li class="group inline-block group-hover:cursor-pointer my-1 underline-offset-4"> <a href="/tags/amazon-web-services/" class="relative pr-2 text-lg underline decoration-dashed group-hover:-top-0.5 group-hover:text-accent focus-visible:p-1 text-sm" data-astro-transition-scope="astro-36ssibgs-3"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block opacity-80 -mr-3.5 size-4"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M5 9l14 0" /><path d="M5 15l14 0" /><path d="M11 4l-4 16" /><path d="M17 4l-4 16" /></svg>
&nbsp;<span>Amazon Web Services</span> </a> </li> </ul> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="ZQIRKt" component-url="/_astro/Comments.pnnUQGGQ.js" component-export="default" renderer-url="/_astro/client.BPIbHqJh.js" props="{}" ssr client="only" opts="{&quot;name&quot;:&quot;Comments&quot;,&quot;value&quot;:&quot;react&quot;}"></astro-island> <div class="mt-4 flex flex-col items-center justify-between gap-6 sm:flex-row sm:items-end sm:gap-4"> <div class="flex flex-col flex-wrap items-center justify-center gap-1 sm:items-start"> <span class="italic">Share this post on:</span> <div class="text-center"> <a href="https://wa.me/?text=https://thuongnn.dev/posts/aws/security/aws-web-application-firewall/" class="group inline-block hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1" title="Share this post via WhatsApp"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M3 21l1.65 -3.8a9 9 0 1 1 3.4 2.9l-5.05 .9" /><path d="M9 10a.5 .5 0 0 0 1 0v-1a.5 .5 0 0 0 -1 0v1a5 5 0 0 0 5 5h1a.5 .5 0 0 0 0 -1h-1a.5 .5 0 0 0 0 1" /></svg> <span class="sr-only">Share this post via WhatsApp</span> </a><a href="https://www.facebook.com/sharer.php?u=https://thuongnn.dev/posts/aws/security/aws-web-application-firewall/" class="group inline-block hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1" title="Share this post on Facebook"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M7 10v4h3v7h4v-7h3l1 -4h-4v-2a1 1 0 0 1 1 -1h3v-4h-3a5 5 0 0 0 -5 5v2h-3" /></svg> <span class="sr-only">Share this post on Facebook</span> </a><a href="https://x.com/intent/post?url=https://thuongnn.dev/posts/aws/security/aws-web-application-firewall/" class="group inline-block hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1" title="Share this post on X"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M4 4l11.733 16h4.267l-11.733 -16z" /><path d="M4 20l6.768 -6.768m2.46 -2.46l6.772 -6.772" /></svg> <span class="sr-only">Share this post on X</span> </a><a href="https://t.me/share/url?url=https://thuongnn.dev/posts/aws/security/aws-web-application-firewall/" class="group inline-block hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1" title="Share this post via Telegram"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M15 10l-4 4l6 6l4 -16l-18 7l4 2l2 6l3 -4" /></svg> <span class="sr-only">Share this post via Telegram</span> </a><a href="https://pinterest.com/pin/create/button/?url=https://thuongnn.dev/posts/aws/security/aws-web-application-firewall/" class="group inline-block hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1" title="Share this post on Pinterest"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M8 20l4 -9" /><path d="M10.7 14c.437 1.263 1.43 2 2.55 2c2.071 0 3.75 -1.554 3.75 -4a5 5 0 1 0 -9.7 1.7" /><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /></svg> <span class="sr-only">Share this post on Pinterest</span> </a><a href="mailto:?subject=See%20this%20post&#38;body=https://thuongnn.dev/posts/aws/security/aws-web-application-firewall/" class="group inline-block hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1" title="Share this post via email"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M3 7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10z" /><path d="M3 7l9 6l9 -6" /></svg> <span class="sr-only">Share this post via email</span> </a> </div> </div> <button id="back-to-top" class="focus-outline py-1 whitespace-nowrap hover:opacity-75"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block rotate-90"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M15 6l-6 6l6 6" /></svg> <span>Back to Top</span> </button> </div> <hr class="my-6 border-dashed"> <!-- Previous/Next Post Buttons --> <div data-pagefind-ignore class="grid grid-cols-1 gap-6 sm:grid-cols-2"> <a href="/posts/aws/other/aws-sns" class="flex w-full gap-1 hover:opacity-75"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block flex-none"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M15 6l-6 6l6 6" /></svg> <div> <span>Previous Post</span> <div class="text-sm text-accent/85">[AWS] Simple Notification Service – SNS</div> </div> </a> <a href="/posts/aws/security/aws-guardduty" class="flex w-full justify-end gap-1 text-right hover:opacity-75 sm:col-start-2"> <div> <span>Next Post</span> <div class="text-sm text-accent/85">[AWS] Amazon GuardDuty</div> </div> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block flex-none"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M9 6l6 6l-6 6" /></svg> </a> </div> </main> <footer class="w-full mt-auto"> <div class="max-w-3xl mx-auto px-0"> <hr class="border-border" aria-hidden="true"> </div> <div class="flex flex-col items-center justify-between py-6 sm:flex-row-reverse sm:py-4"> <div class="flex-wrap justify-center gap-1 flex"> <a href="https://github.com/thuongnn" class="group inline-block hover:text-accent p-2 hover:rotate-6 sm:p-1" title=" thuongnn.dev on Github"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" /></svg> <span class="sr-only"> thuongnn.dev on Github</span> </a><a href="https://www.facebook.com/thuongnn97" class="group inline-block hover:text-accent p-2 hover:rotate-6 sm:p-1" title="thuongnn.dev on Facebook"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M7 10v4h3v7h4v-7h3l1 -4h-4v-2a1 1 0 0 1 1 -1h3v-4h-3a5 5 0 0 0 -5 5v2h-3" /></svg> <span class="sr-only">thuongnn.dev on Facebook</span> </a><a href="https://www.linkedin.com/in/thuongnn/" class="group inline-block hover:text-accent p-2 hover:rotate-6 sm:p-1" title="thuongnn.dev on LinkedIn"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M8 11v5" /><path d="M8 8v.01" /><path d="M12 16v-5" /><path d="M16 16v-3a2 2 0 1 0 -4 0" /><path d="M3 7a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v10a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4z" /></svg> <span class="sr-only">thuongnn.dev on LinkedIn</span> </a><a href="mailto:thuongnn1997@gmail.com" class="group inline-block hover:text-accent p-2 hover:rotate-6 sm:p-1" title="Send an email to thuongnn.dev"> <svg viewBox="0 0 24 24" role="img"  width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M3 7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10z" /><path d="M3 7l9 6l9 -6" /></svg> <span class="sr-only">Send an email to thuongnn.dev</span> </a> </div> <div class="my-2 flex flex-col items-center whitespace-nowrap sm:flex-row"> <span>Copyright &#169; 2025</span> <span class="hidden sm:inline">&nbsp;|&nbsp;</span> <span>All rights reserved.</span> </div> </div> </footer>  </body></html> <script data-astro-rerun>
  /** Create a progress indicator
   *  at the top */
  function createProgressBar() {
    // Create the main container div
    const progressContainer = document.createElement("div");
    progressContainer.className =
      "progress-container fixed top-0 z-10 h-1 w-full bg-background";

    // Create the progress bar div
    const progressBar = document.createElement("div");
    progressBar.className = "progress-bar h-1 w-0 bg-accent";
    progressBar.id = "myBar";

    // Append the progress bar to the progress container
    progressContainer.appendChild(progressBar);

    // Append the progress container to the document body or any other desired parent element
    document.body.appendChild(progressContainer);
  }
  createProgressBar();

  /** Update the progress bar
   *  when user scrolls */
  function updateScrollProgress() {
    document.addEventListener("scroll", () => {
      const winScroll =
        document.body.scrollTop || document.documentElement.scrollTop;
      const height =
        document.documentElement.scrollHeight -
        document.documentElement.clientHeight;
      const scrolled = (winScroll / height) * 100;
      if (document) {
        const myBar = document.getElementById("myBar");
        if (myBar) {
          myBar.style.width = scrolled + "%";
        }
      }
    });
  }
  updateScrollProgress();

  /** Attaches links to headings in the document,
   *  allowing sharing of sections easily */
  function addHeadingLinks() {
    const headings = Array.from(
      document.querySelectorAll("h2, h3, h4, h5, h6")
    );
    for (const heading of headings) {
      heading.classList.add("group");
      const link = document.createElement("a");
      link.className =
        "heading-link ml-2 opacity-0 group-hover:opacity-100 focus:opacity-100";
      link.href = "#" + heading.id;

      const span = document.createElement("span");
      span.ariaHidden = "true";
      span.innerText = "#";
      link.appendChild(span);
      heading.appendChild(link);
    }
  }
  addHeadingLinks();

  /** Attaches copy buttons to code blocks in the document,
   * allowing users to copy code easily. */
  function attachCopyButtons() {
    const copyButtonLabel = "Copy";
    const codeBlocks = Array.from(document.querySelectorAll("pre"));

    for (const codeBlock of codeBlocks) {
      const wrapper = document.createElement("div");
      wrapper.style.position = "relative";

      const copyButton = document.createElement("button");
      copyButton.className =
        "copy-code absolute right-3 -top-3 rounded bg-muted px-2 py-1 text-xs leading-4 text-foreground font-medium";
      copyButton.innerHTML = copyButtonLabel;
      codeBlock.setAttribute("tabindex", "0");
      codeBlock.appendChild(copyButton);

      // wrap codebock with relative parent element
      codeBlock?.parentNode?.insertBefore(wrapper, codeBlock);
      wrapper.appendChild(codeBlock);

      copyButton.addEventListener("click", async () => {
        await copyCode(codeBlock, copyButton);
      });
    }

    async function copyCode(block, button) {
      const code = block.querySelector("code");
      const text = code?.innerText;

      await navigator.clipboard.writeText(text ?? "");

      // visual feedback that task is completed
      button.innerText = "Copied";

      setTimeout(() => {
        button.innerText = copyButtonLabel;
      }, 700);
    }
  }
  attachCopyButtons();

  /** Scrolls the document to the top when
   * the "Back to Top" button is clicked. */
  function backToTop() {
    document.querySelector("#back-to-top")?.addEventListener("click", () => {
      document.body.scrollTop = 0; // For Safari
      document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
    });
  }
  backToTop();

  /* Go to page start after page swap */
  document.addEventListener("astro:after-swap", () =>
    window.scrollTo({ left: 0, top: 0, behavior: "instant" })
  );
</script>